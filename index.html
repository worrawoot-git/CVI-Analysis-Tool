<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CVI Analysis Tool (Updated Version)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Sarabun', sans-serif; background-color: #f8fafc; }
        .step-active { color: #2563eb; border-bottom: 3px solid #2563eb; }
        .table-input:focus { outline: none; border: 2px solid #2563eb; }
    </style>
</head>
<body class="p-4 md:p-8">

    <div class="max-w-6xl mx-auto bg-white shadow-xl rounded-2xl overflow-hidden">
        <div class="bg-blue-700 p-6 text-white text-center">
            <h1 class="text-2xl font-bold">CVI Analysis Tool <span class="text-sm font-normal">(Updated Version)</span></h1>
            <p class="text-blue-100 text-sm mt-1">‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏î‡∏±‡∏ä‡∏ô‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏á‡∏ï‡∏£‡∏á‡πÄ‡∏ä‡∏¥‡∏á‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏ï‡∏≤‡∏°‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô Lynn (1986) & Polit (2006)</p>
        </div>

        <div class="flex justify-between border-b bg-gray-50 px-6 py-4 text-xs md:text-sm font-semibold text-gray-400">
            <div id="step1-label" class="step-active pb-2">1. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</div>
            <div id="step2-label" class="pb-2">2. ‡∏õ‡πâ‡∏≠‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</div>
            <div id="step3-label" class="pb-2">3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</div>
            <div id="step4-label" class="pb-2">4. ‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•</div>
            <div id="step5-label" class="pb-2">5. ‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•</div>
        </div>

        <div class="p-6">
            <div id="step1" class="step-content">
                <h3 class="text-lg font-bold mb-4 text-gray-700">‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç (3-10 ‡∏Ñ‡∏ô)</label>
                        <input type="number" id="expertCount" min="3" max="10" value="3" class="mt-1 block w-full border border-gray-300 rounded-md p-2">
                        <p class="text-xs text-red-500 mt-1">* ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 3 ‡∏Ñ‡∏ô‡∏ï‡∏≤‡∏°‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô</p>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô (Item)</label>
                        <input type="number" id="itemCount" min="1" value="5" class="mt-1 block w-full border border-gray-300 rounded-md p-2">
                    </div>
                </div>
                <button onclick="goToStep2()" class="mt-8 w-full bg-blue-600 text-white py-3 rounded-lg hover:bg-blue-700 transition">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ: ‡∏õ‡πâ‡∏≠‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
            </div>

            <div id="step2" class="step-content hidden">
                <h3 class="text-lg font-bold mb-2 text-gray-700">‡∏õ‡πâ‡∏≠‡∏ô‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô</h3>
                <p class="text-sm text-gray-500 mb-4">(‡πÄ‡∏Å‡∏ì‡∏ë‡πå: 1=‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á, 2=‡∏Ñ‡∏ß‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á, 3=‡∏ï‡∏£‡∏á, 4=‡∏ï‡∏£‡∏á‡∏°‡∏≤‡∏Å)</p>
                
                <div class="mb-4 flex flex-wrap gap-2">
                    <button onclick="renderInputTable()" class="text-xs bg-gray-200 px-3 py-1 rounded hover:bg-gray-300">‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏ï‡∏≤‡∏£‡∏≤‡∏á</button>
                    <button onclick="importFromClipboard()" class="text-xs bg-green-100 text-green-700 px-3 py-1 rounded border border-green-200 hover:bg-green-200">‡∏ß‡∏≤‡∏á‡∏à‡∏≤‡∏Å Excel</button>
                    <div class="border-l mx-2"></div>
                    <button onclick="addNewRow()" class="text-xs bg-blue-600 text-white px-3 py-1 rounded hover:bg-blue-700 shadow-sm">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°</button>
                    <button onclick="removeLastRow()" class="text-xs bg-red-100 text-red-600 px-3 py-1 rounded border border-red-200 hover:bg-red-200">‚ûñ ‡∏•‡∏ö‡πÅ‡∏ñ‡∏ß‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</button>
                </div>

                <div class="overflow-x-auto border rounded-lg">
                    <table class="min-w-full divide-y divide-gray-200" id="inputTable">
                        <thead class="bg-gray-50">
                            <tr id="tableHeader"></tr>
                        </thead>
                        <tbody id="tableBody" class="bg-white divide-y divide-gray-200"></tbody>
                    </table>
                </div>

                <div class="flex gap-4 mt-6">
                    <button onclick="prevStep(1)" class="w-1/3 bg-gray-200 text-gray-700 py-3 rounded-lg">‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</button>
                    <button onclick="validateAndGoToStep3()" class="w-2/3 bg-blue-600 text-white py-3 rounded-lg hover:bg-blue-700">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</button>
                </div>
            </div>

            <div id="step3" class="step-content hidden text-center py-10">
                <div id="validatorMsg">
                    <div class="inline-flex items-center justify-center p-4 bg-green-100 text-green-700 rounded-full mb-4">
                        <svg class="w-12 h-12" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
                    </div>
                    <h3 class="text-xl font-bold">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì</h3>
                    <p class="text-gray-500 mt-2">‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡πâ‡∏ß ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ñ‡πà‡∏≤‡∏ß‡πà‡∏≤‡∏á‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ó‡∏µ‡πà‡∏ú‡∏¥‡∏î‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö</p>
                    <button onclick="calculateCVI()" class="mt-8 px-10 bg-indigo-600 text-white py-4 rounded-xl text-lg font-bold shadow-lg hover:bg-indigo-700 animate-bounce">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì (Process)</button>
                </div>
            </div>

            <div id="step5" class="step-content hidden">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                    <div class="bg-blue-50 p-4 rounded-xl border border-blue-100 text-center">
                        <span class="text-sm text-blue-600 font-bold">S-CVI/Ave</span>
                        <div id="resAve" class="text-3xl font-bold text-blue-800">-</div>
                    </div>
                    <div class="bg-indigo-50 p-4 rounded-xl border border-indigo-100 text-center">
                        <span class="text-sm text-indigo-600 font-bold">S-CVI/UA</span>
                        <div id="resUA" class="text-3xl font-bold text-indigo-800">-</div>
                    </div>
                    <div class="bg-gray-50 p-4 rounded-xl border border-gray-100 text-center">
                        <span class="text-sm text-gray-600 font-bold">‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏Å‡∏≤‡∏£‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö (Lynn)</span>
                        <div id="resCriteria" class="text-lg font-bold text-gray-800">-</div>
                    </div>
                </div>

                <div class="overflow-x-auto border rounded-lg mb-6">
                    <table class="min-w-full text-sm">
                        <thead class="bg-gray-800 text-white text-center">
                            <tr>
                                <th class="p-2">‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà</th>
                                <th class="p-2">‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç‡∏ó‡∏µ‡πà‡πÄ‡∏´‡πá‡∏ô‡∏û‡πâ‡∏≠‡∏á (3-4)</th>
                                <th class="p-2">I-CVI</th>
                                <th class="p-2">95% CI</th>
                                <th class="p-2">‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤</th>
                            </tr>
                        </thead>
                        <tbody id="resultTableBody" class="text-center divide-y"></tbody>
                    </table>
                </div>

                <div class="bg-yellow-50 p-4 rounded-lg border border-yellow-200 mb-6">
                    <h4 class="font-bold text-yellow-800 mb-1">‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ó‡∏≤‡∏á‡∏ß‡∏¥‡∏ä‡∏≤‡∏Å‡∏≤‡∏£:</h4>
                    <ul id="academicAdvice" class="list-disc list-inside text-sm text-yellow-900"></ul>
                </div>

                <button onclick="window.print()" class="w-full bg-gray-800 text-white py-3 rounded-lg flex items-center justify-center gap-2">
                    <span>üñ®Ô∏è ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏ß‡∏¥‡∏à‡∏±‡∏¢</span>
                </button>
                <button onclick="location.reload()" class="w-full mt-2 text-gray-500 text-sm underline">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà</button>
            </div>
        </div>
    </div>

    <script>
        let config = { experts: 3, items: 5 };
        
        function goToStep2() {
            config.experts = parseInt(document.getElementById('expertCount').value);
            config.items = parseInt(document.getElementById('itemCount').value);
            
            if(config.experts < 3) return alert("‡∏ï‡∏≤‡∏°‡∏´‡∏•‡∏±‡∏Å‡∏ß‡∏¥‡∏ä‡∏≤‡∏Å‡∏≤‡∏£‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 3 ‡∏Ñ‡∏ô");
            
            renderInputTable();
            switchStep(2);
        }

        function renderInputTable() {
            const header = document.getElementById('tableHeader');
            const body = document.getElementById('tableBody');
            
            header.innerHTML = '<th class="p-2 text-left border-r w-20 text-center">‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà</th>';
            for(let i=1; i<=config.experts; i++) {
                header.innerHTML += `<th class="p-2 text-center text-xs">‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç ${i}</th>`;
            }

            body.innerHTML = '';
            for(let i=1; i<=config.items; i++) {
                addRowToTable(i);
            }
        }

        function addRowToTable(rowNumber) {
            const body = document.getElementById('tableBody');
            let row = document.createElement('tr');
            row.className = 'hover:bg-gray-50 item-row';
            
            let html = `<td class="p-2 font-bold border-r text-center item-num">${rowNumber}</td>`;
            for(let j=1; j<=config.experts; j++) {
                html += `<td class="p-1">
                    <input type="number" min="1" max="4" class="cell-input w-full text-center p-1 border rounded" data-col="${j}">
                </td>`;
            }
            row.innerHTML = html;
            body.appendChild(row);
        }

        function addNewRow() {
            const currentRows = document.querySelectorAll('.item-row').length;
            config.items = currentRows + 1;
            addRowToTable(config.items);
        }

        function removeLastRow() {
            const rows = document.querySelectorAll('.item-row');
            if(rows.length > 1) {
                rows[rows.length - 1].remove();
                config.items = rows.length - 1;
            } else {
                alert("‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1 ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°");
            }
        }

        async function importFromClipboard() {
            try {
                const text = await navigator.clipboard.readText();
                const lines = text.trim().split(/\r?\n/);
                
                // ‡∏õ‡∏£‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏ñ‡∏ß‡πÉ‡∏´‡πâ‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà copy ‡∏°‡∏≤
                const body = document.getElementById('tableBody');
                body.innerHTML = '';
                config.items = lines.length;
                
                lines.forEach((line, index) => {
                    addRowToTable(index + 1);
                    const cols = line.split('\t');
                    const inputs = body.lastElementChild.querySelectorAll('.cell-input');
                    cols.forEach((val, colIdx) => {
                        if(inputs[colIdx]) {
                            let cleanVal = parseInt(val.trim());
                            if(cleanVal >= 1 && cleanVal <= 4) inputs[colIdx].value = cleanVal;
                        }
                    });
                });
            } catch (err) { alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á Clipboard ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ‡∏ß‡∏¥‡∏ò‡∏µ‡∏û‡∏¥‡∏°‡∏û‡πå"); }
        }

        function validateAndGoToStep3() {
            const inputs = document.querySelectorAll('.cell-input');
            let isValid = true;
            inputs.forEach(input => {
                if(!input.value || input.value < 1 || input.value > 4) {
                    input.classList.add('border-red-500');
                    isValid = false;
                } else {
                    input.classList.remove('border-red-500');
                }
            });

            if(!isValid) return alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô (‡∏Ñ‡πà‡∏≤ 1-4)");
            switchStep(3);
        }

        function calculateCVI() {
            const rows = document.querySelectorAll('.item-row');
            config.items = rows.length; // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ç‡πâ‡∏≠‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏Å‡πà‡∏≠‡∏ô‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì
            
            let itemCVIs = [];
            let universalAgreements = 0;
            const acceptableICVI = config.experts <= 5 ? 1.00 : 0.78;

            const tableBody = document.getElementById('resultTableBody');
            tableBody.innerHTML = '';

            rows.forEach((row, index) => {
                const inputs = row.querySelectorAll('.cell-input');
                let scores = [];
                inputs.forEach(input => scores.push(parseInt(input.value)));

                const agreed = scores.filter(s => s >= 3).length;
                const iCVI = agreed / config.experts;
                const isUA = agreed === config.experts ? 1 : 0;
                universalAgreements += isUA;
                
                const z = 1.96;
                const ci_low = (2 * agreed + z*z - z * Math.sqrt(z*z + 4 * agreed * (1 - iCVI))) / (2 * (config.experts + z*z));
                const ci_high = (2 * agreed + z*z + z * Math.sqrt(z*z + 4 * agreed * (1 - iCVI))) / (2 * (config.experts + z*z));

                itemCVIs.push(iCVI);
                const status = iCVI >= acceptableICVI ? '<span class="text-green-600">‡∏ú‡πà‡∏≤‡∏ô</span>' : '<span class="text-red-600 font-bold">‡∏Ñ‡∏ß‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á</span>';

                tableBody.innerHTML += `
                    <tr>
                        <td class="p-2">${index + 1}</td>
                        <td class="p-2">${agreed}</td>
                        <td class="p-2 font-semibold">${iCVI.toFixed(3)}</td>
                        <td class="p-2 text-xs text-gray-500">[${ci_low.toFixed(2)}, ${ci_high.toFixed(2)}]</td>
                        <td class="p-2">${status}</td>
                    </tr>
                `;
            });

            const sCVIAve = itemCVIs.reduce((a, b) => a + b) / config.items;
            const sCVIUA = universalAgreements / config.items;

            document.getElementById('resAve').innerText = sCVIAve.toFixed(3);
            document.getElementById('resUA').innerText = sCVIUA.toFixed(3);
            document.getElementById('resCriteria').innerText = `I-CVI ‚â• ${acceptableICVI}`;

            const advice = document.getElementById('academicAdvice');
            advice.innerHTML = `
                <li>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç ${config.experts} ‡∏Ñ‡∏ô ‡πÄ‡∏Å‡∏ì‡∏ë‡πå I-CVI ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥‡∏Ñ‡∏∑‡∏≠ ${acceptableICVI} (Lynn, 1986)</li>
                <li>S-CVI/Ave ‡∏£‡∏ß‡∏° ${config.items} ‡∏Ç‡πâ‡∏≠ ‡∏Ñ‡∏ß‡∏£‡∏°‡∏µ‡∏Ñ‡πà‡∏≤ ‚â• 0.90 (Polit & Beck, 2006)</li>
                ${sCVIAve >= 0.9 ? '<li>‡∏™‡∏£‡∏∏‡∏õ: ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡∏£‡∏á‡πÄ‡∏ä‡∏¥‡∏á‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö‡πÑ‡∏î‡πâ</li>' : '<li class="text-red-600">‡∏™‡∏£‡∏∏‡∏õ: ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏ï‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏Å‡∏ì‡∏ë‡πå</li>'}
            `;

            switchStep(5);
        }

        function switchStep(n) {
            document.querySelectorAll('.step-content').forEach(s => s.classList.add('hidden'));
            const target = document.getElementById('step' + n);
            if(target) target.classList.remove('hidden');
            
            for(let i=1; i<=5; i++){
                const lbl = document.getElementById(`step${i}-label`);
                if(lbl) {
                    if(i <= n) lbl.classList.add('step-active');
                    else lbl.classList.remove('step-active');
                }
            }
        }

        function prevStep(n) { switchStep(n); }
    </script>
</body>
</html>
